name: Generate FSM Diagrams

on:
  push:
    branches: [ master ]
    paths: [ "**_fsm.h" ]
    
jobs:
  generate-fsm-diagrams:
    name: Generate FSM Diagrams
    runs-on: ubuntu-20.04
    steps:
      - name: Checkout repo content
        uses: actions/checkout@v3

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"

      - name: Execute FSM diagram generator script
        run: python ./src/software/ai/fsm_diagram_generator.py

      - name: Create pull request
        uses: peter-evans/create-pull-request@v4
        with:
          commit-message: Update FSM diagrams
          branch: update-fsm-diagrams
          title: Update FSM diagrams
          body: |
            Updates Play and Tactic FSM diagrams.

            ---

            This PR was auto-generated by the `generate-fsm-diagrams` GitHub action.
          reviewers: |
            ${{ github.actor }}
          token: ${{ secrets.WRITE_TO_PULL_REQUEST_SECRET }}
