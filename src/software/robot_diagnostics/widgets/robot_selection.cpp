#include "software/robot_diagnostics/widgets/robot_selection.h"

#include <g3log/g3log.hpp>

void setupRobotSelection(Ui::AutoGeneratedMainWidget *widget,
                         unsigned int &robot_selection)
{
    // clang-format off
    widget->comboBox_robot_selection->addItems({
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7",
        "8",
        "9",
        "10",
        "11",
        "12",
        "13",
        "14",
        "15",
        "16"});
    // clang-format on

    auto on_robot_selection_changed = [&robot_selection](const QString &text) {
        bool ok;
        unsigned int combo_box_input = text.toUInt(&ok, 10);  // hex == 255, ok == true

        if (!ok)
        {
            LOG(FATAL) << "Tried to set the robot selection with an invalid value: '"
                       << text.toStdString() << "'" << std::endl;
        }
        else
        {
            robot_selection = combo_box_input;
        }
    };

    QWidget::connect(widget->comboBox_robot_selection, &QComboBox::currentTextChanged,
                     on_robot_selection_changed);
}
